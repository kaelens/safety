{"ast":null,"code":"const npm = require('../npm.js');\n\nconst {\n  format\n} = require('util');\n\nconst {\n  resolve\n} = require('path');\n\nconst nameValidator = require('validate-npm-package-name');\n\nconst npmlog = require('npmlog');\n\nconst replaceInfo = require('./replace-info.js');\n\nconst {\n  report: explainEresolve\n} = require('./explain-eresolve.js');\n\nmodule.exports = er => {\n  const short = [];\n  const detail = [];\n  if (er.message) er.message = replaceInfo(er.message);\n  if (er.stack) er.stack = replaceInfo(er.stack);\n\n  switch (er.code) {\n    case 'ERESOLVE':\n      short.push(['ERESOLVE', er.message]);\n      detail.push(['', '']);\n      detail.push(['', explainEresolve(er)]);\n      break;\n\n    case 'ENOLOCK':\n      {\n        const cmd = npm.command || '';\n        short.push([cmd, 'This command requires an existing lockfile.']);\n        detail.push([cmd, 'Try creating one first with: npm i --package-lock-only']);\n        detail.push([cmd, `Original error: ${er.message}`]);\n        break;\n      }\n\n    case 'ENOAUDIT':\n      short.push(['audit', er.message]);\n      break;\n\n    case 'ECONNREFUSED':\n      short.push(['', er]);\n      detail.push(['', ['\\nIf you are behind a proxy, please make sure that the', \"'proxy' config is set properly.  See: 'npm help config'\"].join('\\n')]);\n      break;\n\n    case 'EACCES':\n    case 'EPERM':\n      {\n        const isCachePath = typeof er.path === 'string' && npm.config.loaded && er.path.startsWith(npm.config.get('cache'));\n        const isCacheDest = typeof er.dest === 'string' && npm.config.loaded && er.dest.startsWith(npm.config.get('cache'));\n\n        const isWindows = require('./is-windows.js');\n\n        if (!isWindows && (isCachePath || isCacheDest)) {\n          // user probably doesn't need this, but still add it to the debug log\n          npmlog.verbose(er.stack);\n          short.push(['', ['', 'Your cache folder contains root-owned files, due to a bug in', 'previous versions of npm which has since been addressed.', '', 'To permanently fix this problem, please run:', `  sudo chown -R ${process.getuid()}:${process.getgid()} ${JSON.stringify(npm.config.get('cache'))}`].join('\\n')]);\n        } else {\n          short.push(['', er]);\n          detail.push(['', ['\\nThe operation was rejected by your operating system.', isWindows ? 'It\\'s possible that the file was already in use (by a text editor or antivirus),\\n' + 'or that you lack permissions to access it.' : 'It is likely you do not have the permissions to access this file as the current user', '\\nIf you believe this might be a permissions issue, please double-check the', 'permissions of the file and its containing directories, or try running', 'the command again as root/Administrator.'].join('\\n')]);\n        }\n\n        break;\n      }\n\n    case 'ENOGIT':\n      short.push(['', er.message]);\n      detail.push(['', ['', 'Failed using git.', 'Please check if you have git installed and in your PATH.'].join('\\n')]);\n      break;\n\n    case 'EJSONPARSE':\n      // Check whether we ran into a conflict in our own package.json\n      if (er.file === resolve(npm.prefix, 'package.json')) {\n        const {\n          isDiff\n        } = require('parse-conflict-json');\n\n        const txt = require('fs').readFileSync(er.file, 'utf8').replace(/\\r\\n/g, '\\n');\n\n        if (isDiff(txt)) {\n          detail.push(['', ['Merge conflict detected in your package.json.', '', 'Please resolve the package.json conflict and retry the command:', '', `$ ${process.argv.join(' ')}`].join('\\n')]);\n          break;\n        }\n      }\n\n      short.push(['JSON.parse', er.message]);\n      detail.push(['JSON.parse', ['Failed to parse JSON data.', 'Note: package.json must be actual JSON, not just JavaScript.'].join('\\n')]);\n      break;\n\n    case 'EOTP':\n    case 'E401':\n      // E401 is for places where we accidentally neglect OTP stuff\n      if (er.code === 'EOTP' || /one-time pass/.test(er.message)) {\n        short.push(['', 'This operation requires a one-time password from your authenticator.']);\n        detail.push(['', ['You can provide a one-time password by passing --otp=<code> to the command you ran.', 'If you already provided a one-time password then it is likely that you either typoed', 'it, or it timed out. Please try again.'].join('\\n')]);\n      } else {\n        // npm ERR! code E401\n        // npm ERR! Unable to authenticate, need: Basic\n        const auth = !er.headers || !er.headers['www-authenticate'] ? [] : er.headers['www-authenticate'].map(au => au.split(/[,\\s]+/))[0];\n\n        if (auth.includes('Bearer')) {\n          short.push(['', 'Unable to authenticate, your authentication token seems to be invalid.']);\n          detail.push(['', ['To correct this please trying logging in again with:', '    npm login'].join('\\n')]);\n        } else if (auth.includes('Basic')) {\n          short.push(['', 'Incorrect or missing password.']);\n          detail.push(['', ['If you were trying to login, change your password, create an', 'authentication token or enable two-factor authentication then', 'that means you likely typed your password in incorrectly.', 'Please try again, or recover your password at:', '    https://www.npmjs.com/forgot', '', 'If you were doing some other operation then your saved credentials are', 'probably out of date. To correct this please try logging in again with:', '    npm login'].join('\\n')]);\n        } else short.push(['', er.message || er]);\n      }\n\n      break;\n\n    case 'E404':\n      // There's no need to have 404 in the message as well.\n      short.push(['404', er.message.replace(/^404\\s+/, '')]);\n\n      if (er.pkgid && er.pkgid !== '-') {\n        const pkg = er.pkgid.replace(/(?!^)@.*$/, '');\n        detail.push(['404', '']);\n        detail.push(['404', '', \"'\" + er.pkgid + \"' is not in the npm registry.\"]);\n        const valResult = nameValidator(pkg);\n        if (valResult.validForNewPackages) detail.push(['404', 'You should bug the author to publish it (or use the name yourself!)']);else {\n          detail.push(['404', 'This package name is not valid, because', '']);\n          const errorsArray = [...(valResult.errors || []), ...(valResult.warnings || [])];\n          errorsArray.forEach((item, idx) => detail.push(['404', ' ' + (idx + 1) + '. ' + item]));\n        }\n        detail.push(['404', '\\nNote that you can also install from a']);\n        detail.push(['404', 'tarball, folder, http url, or git url.']);\n      }\n\n      break;\n\n    case 'EPUBLISHCONFLICT':\n      short.push(['publish fail', 'Cannot publish over existing version.']);\n      detail.push(['publish fail', \"Update the 'version' field in package.json and try again.\"]);\n      detail.push(['publish fail', '']);\n      detail.push(['publish fail', 'To automatically increment version numbers, see:']);\n      detail.push(['publish fail', '    npm help version']);\n      break;\n\n    case 'EISGIT':\n      short.push(['git', er.message]);\n      short.push(['git', '    ' + er.path]);\n      detail.push(['git', ['Refusing to remove it. Update manually,', 'or move it out of the way first.'].join('\\n')]);\n      break;\n\n    case 'EBADPLATFORM':\n      {\n        const validOs = er.required && er.required.os && er.required.os.join ? er.required.os.join(',') : er.required.os;\n        const validArch = er.required && er.required.cpu && er.required.cpu.join ? er.required.cpu.join(',') : er.required.cpu;\n        const expected = {\n          os: validOs,\n          arch: validArch\n        };\n        const actual = {\n          os: process.platform,\n          arch: process.arch\n        };\n        short.push(['notsup', [format('Unsupported platform for %s: wanted %j (current: %j)', er.pkgid, expected, actual)].join('\\n')]);\n        detail.push(['notsup', ['Valid OS:    ' + validOs, 'Valid Arch:  ' + validArch, 'Actual OS:   ' + process.platform, 'Actual Arch: ' + process.arch].join('\\n')]);\n        break;\n      }\n\n    case 'EEXIST':\n      short.push(['', er.message]);\n      short.push(['', 'File exists: ' + (er.dest || er.path)]);\n      detail.push(['', 'Remove the existing file and try again, or run npm']);\n      detail.push(['', 'with --force to overwrite files recklessly.']);\n      break;\n\n    case 'ENEEDAUTH':\n      short.push(['need auth', er.message]);\n      detail.push(['need auth', 'You need to authorize this machine using `npm adduser`']);\n      break;\n\n    case 'ECONNRESET':\n    case 'ENOTFOUND':\n    case 'ETIMEDOUT':\n    case 'EAI_FAIL':\n      short.push(['network', er.message]);\n      detail.push(['network', ['This is a problem related to network connectivity.', 'In most cases you are behind a proxy or have bad network settings.', '\\nIf you are behind a proxy, please make sure that the', \"'proxy' config is set properly.  See: 'npm help config'\"].join('\\n')]);\n      break;\n\n    case 'ETARGET':\n      short.push(['notarget', er.message]);\n      detail.push(['notarget', ['In most cases you or one of your dependencies are requesting', \"a package version that doesn't exist.\"].join('\\n')]);\n      break;\n\n    case 'E403':\n      short.push(['403', er.message]);\n      detail.push(['403', ['In most cases, you or one of your dependencies are requesting', 'a package version that is forbidden by your security policy, or', 'on a server you do not have access to.'].join('\\n')]);\n      break;\n\n    case 'EBADENGINE':\n      short.push(['engine', er.message]);\n      short.push(['engine', 'Not compatible with your version of node/npm: ' + er.pkgid]);\n      detail.push(['notsup', ['Not compatible with your version of node/npm: ' + er.pkgid, 'Required: ' + JSON.stringify(er.required), 'Actual:   ' + JSON.stringify({\n        npm: npm.version,\n        node: npm.config.loaded ? npm.config.get('node-version') : process.version\n      })].join('\\n')]);\n      break;\n\n    case 'ENOSPC':\n      short.push(['nospc', er.message]);\n      detail.push(['nospc', ['There appears to be insufficient space on your system to finish.', 'Clear up some disk space and try again.'].join('\\n')]);\n      break;\n\n    case 'EROFS':\n      short.push(['rofs', er.message]);\n      detail.push(['rofs', ['Often virtualized file systems, or other file systems', \"that don't support symlinks, give this error.\"].join('\\n')]);\n      break;\n\n    case 'ENOENT':\n      short.push(['enoent', er.message]);\n      detail.push(['enoent', ['This is related to npm not being able to find a file.', er.file ? \"\\nCheck if the file '\" + er.file + \"' is present.\" : ''].join('\\n')]);\n      break;\n\n    case 'EMISSINGARG':\n    case 'EUNKNOWNTYPE':\n    case 'EINVALIDTYPE':\n    case 'ETOOMANYARGS':\n      short.push(['typeerror', er.stack]);\n      detail.push(['typeerror', ['This is an error with npm itself. Please report this error at:', '    https://github.com/npm/cli/issues'].join('\\n')]);\n      break;\n\n    default:\n      short.push(['', er.message || er]);\n      if (er.signal) detail.push(['signal', er.signal]);\n      if (er.cmd && Array.isArray(er.args)) detail.push(['command', ...[er.cmd, ...er.args]]);\n      if (er.stdout) detail.push(['', er.stdout.trim()]);\n      if (er.stderr) detail.push(['', er.stderr.trim()]);\n      break;\n  }\n\n  return {\n    summary: short,\n    detail: detail\n  };\n};","map":{"version":3,"sources":["/Users/kaelen/nsc-mds/node_modules/npm/lib/utils/error-message.js"],"names":["npm","require","format","resolve","nameValidator","npmlog","replaceInfo","report","explainEresolve","module","exports","er","short","detail","message","stack","code","push","cmd","command","join","isCachePath","path","config","loaded","startsWith","get","isCacheDest","dest","isWindows","verbose","process","getuid","getgid","JSON","stringify","file","prefix","isDiff","txt","readFileSync","replace","argv","test","auth","headers","map","au","split","includes","pkgid","pkg","valResult","validForNewPackages","errorsArray","errors","warnings","forEach","item","idx","validOs","required","os","validArch","cpu","expected","arch","actual","platform","version","node","signal","Array","isArray","args","stdout","trim","stderr","summary"],"mappings":"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","sourcesContent":["const npm = require('../npm.js')\nconst { format } = require('util')\nconst { resolve } = require('path')\nconst nameValidator = require('validate-npm-package-name')\nconst npmlog = require('npmlog')\nconst replaceInfo = require('./replace-info.js')\nconst { report: explainEresolve } = require('./explain-eresolve.js')\n\nmodule.exports = (er) => {\n  const short = []\n  const detail = []\n\n  if (er.message)\n    er.message = replaceInfo(er.message)\n  if (er.stack)\n    er.stack = replaceInfo(er.stack)\n\n  switch (er.code) {\n    case 'ERESOLVE':\n      short.push(['ERESOLVE', er.message])\n      detail.push(['', ''])\n      detail.push(['', explainEresolve(er)])\n      break\n\n    case 'ENOLOCK': {\n      const cmd = npm.command || ''\n      short.push([cmd, 'This command requires an existing lockfile.'])\n      detail.push([cmd, 'Try creating one first with: npm i --package-lock-only'])\n      detail.push([cmd, `Original error: ${er.message}`])\n      break\n    }\n\n    case 'ENOAUDIT':\n      short.push(['audit', er.message])\n      break\n\n    case 'ECONNREFUSED':\n      short.push(['', er])\n      detail.push([\n        '',\n        [\n          '\\nIf you are behind a proxy, please make sure that the',\n          \"'proxy' config is set properly.  See: 'npm help config'\",\n        ].join('\\n'),\n      ])\n      break\n\n    case 'EACCES':\n    case 'EPERM': {\n      const isCachePath = typeof er.path === 'string' &&\n        npm.config.loaded && er.path.startsWith(npm.config.get('cache'))\n      const isCacheDest = typeof er.dest === 'string' &&\n        npm.config.loaded && er.dest.startsWith(npm.config.get('cache'))\n\n      const isWindows = require('./is-windows.js')\n\n      if (!isWindows && (isCachePath || isCacheDest)) {\n        // user probably doesn't need this, but still add it to the debug log\n        npmlog.verbose(er.stack)\n        short.push([\n          '',\n          [\n            '',\n            'Your cache folder contains root-owned files, due to a bug in',\n            'previous versions of npm which has since been addressed.',\n            '',\n            'To permanently fix this problem, please run:',\n            `  sudo chown -R ${process.getuid()}:${process.getgid()} ${JSON.stringify(npm.config.get('cache'))}`,\n          ].join('\\n'),\n        ])\n      } else {\n        short.push(['', er])\n        detail.push([\n          '',\n          [\n            '\\nThe operation was rejected by your operating system.',\n            (isWindows\n              ? 'It\\'s possible that the file was already in use (by a text editor or antivirus),\\n' +\n                'or that you lack permissions to access it.'\n              : 'It is likely you do not have the permissions to access this file as the current user'),\n            '\\nIf you believe this might be a permissions issue, please double-check the',\n            'permissions of the file and its containing directories, or try running',\n            'the command again as root/Administrator.',\n          ].join('\\n')])\n      }\n      break\n    }\n\n    case 'ENOGIT':\n      short.push(['', er.message])\n      detail.push([\n        '',\n        [\n          '',\n          'Failed using git.',\n          'Please check if you have git installed and in your PATH.',\n        ].join('\\n'),\n      ])\n      break\n\n    case 'EJSONPARSE':\n      // Check whether we ran into a conflict in our own package.json\n      if (er.file === resolve(npm.prefix, 'package.json')) {\n        const { isDiff } = require('parse-conflict-json')\n        const txt = require('fs').readFileSync(er.file, 'utf8')\n          .replace(/\\r\\n/g, '\\n')\n        if (isDiff(txt)) {\n          detail.push([\n            '',\n            [\n              'Merge conflict detected in your package.json.',\n              '',\n              'Please resolve the package.json conflict and retry the command:',\n              '',\n              `$ ${process.argv.join(' ')}`,\n            ].join('\\n'),\n          ])\n          break\n        }\n      }\n      short.push(['JSON.parse', er.message])\n      detail.push([\n        'JSON.parse',\n        [\n          'Failed to parse JSON data.',\n          'Note: package.json must be actual JSON, not just JavaScript.',\n        ].join('\\n'),\n      ])\n      break\n\n    case 'EOTP':\n    case 'E401':\n      // E401 is for places where we accidentally neglect OTP stuff\n      if (er.code === 'EOTP' || /one-time pass/.test(er.message)) {\n        short.push(['', 'This operation requires a one-time password from your authenticator.'])\n        detail.push([\n          '',\n          [\n            'You can provide a one-time password by passing --otp=<code> to the command you ran.',\n            'If you already provided a one-time password then it is likely that you either typoed',\n            'it, or it timed out. Please try again.',\n          ].join('\\n'),\n        ])\n      } else {\n        // npm ERR! code E401\n        // npm ERR! Unable to authenticate, need: Basic\n        const auth = !er.headers || !er.headers['www-authenticate'] ? []\n          : er.headers['www-authenticate'].map((au) => au.split(/[,\\s]+/))[0]\n\n        if (auth.includes('Bearer')) {\n          short.push(['', 'Unable to authenticate, your authentication token seems to be invalid.'])\n          detail.push([\n            '',\n            [\n              'To correct this please trying logging in again with:',\n              '    npm login',\n            ].join('\\n'),\n          ])\n        } else if (auth.includes('Basic')) {\n          short.push(['', 'Incorrect or missing password.'])\n          detail.push([\n            '',\n            [\n              'If you were trying to login, change your password, create an',\n              'authentication token or enable two-factor authentication then',\n              'that means you likely typed your password in incorrectly.',\n              'Please try again, or recover your password at:',\n              '    https://www.npmjs.com/forgot',\n              '',\n              'If you were doing some other operation then your saved credentials are',\n              'probably out of date. To correct this please try logging in again with:',\n              '    npm login',\n            ].join('\\n'),\n          ])\n        } else\n          short.push(['', er.message || er])\n      }\n      break\n\n    case 'E404':\n      // There's no need to have 404 in the message as well.\n      short.push(['404', er.message.replace(/^404\\s+/, '')])\n      if (er.pkgid && er.pkgid !== '-') {\n        const pkg = er.pkgid.replace(/(?!^)@.*$/, '')\n\n        detail.push(['404', ''])\n        detail.push(['404', '', \"'\" + er.pkgid + \"' is not in the npm registry.\"])\n\n        const valResult = nameValidator(pkg)\n\n        if (valResult.validForNewPackages)\n          detail.push(['404', 'You should bug the author to publish it (or use the name yourself!)'])\n        else {\n          detail.push(['404', 'This package name is not valid, because', ''])\n\n          const errorsArray = [\n            ...(valResult.errors || []),\n            ...(valResult.warnings || []),\n          ]\n          errorsArray.forEach((item, idx) => detail.push([\n            '404',\n            ' ' + (idx + 1) + '. ' + item,\n          ]))\n        }\n\n        detail.push(['404', '\\nNote that you can also install from a'])\n        detail.push(['404', 'tarball, folder, http url, or git url.'])\n      }\n      break\n\n    case 'EPUBLISHCONFLICT':\n      short.push(['publish fail', 'Cannot publish over existing version.'])\n      detail.push(['publish fail', \"Update the 'version' field in package.json and try again.\"])\n      detail.push(['publish fail', ''])\n      detail.push(['publish fail', 'To automatically increment version numbers, see:'])\n      detail.push(['publish fail', '    npm help version'])\n      break\n\n    case 'EISGIT':\n      short.push(['git', er.message])\n      short.push(['git', '    ' + er.path])\n      detail.push([\n        'git',\n        [\n          'Refusing to remove it. Update manually,',\n          'or move it out of the way first.',\n        ].join('\\n'),\n      ])\n      break\n\n    case 'EBADPLATFORM': {\n      const validOs = er.required &&\n        er.required.os &&\n        er.required.os.join ? er.required.os.join(',') : er.required.os\n      const validArch = er.required &&\n        er.required.cpu &&\n        er.required.cpu.join ? er.required.cpu.join(',') : er.required.cpu\n      const expected = { os: validOs, arch: validArch }\n      const actual = { os: process.platform, arch: process.arch }\n      short.push([\n        'notsup',\n        [\n          format('Unsupported platform for %s: wanted %j (current: %j)', er.pkgid, expected, actual),\n        ].join('\\n'),\n      ])\n      detail.push([\n        'notsup',\n        [\n          'Valid OS:    ' + validOs,\n          'Valid Arch:  ' + validArch,\n          'Actual OS:   ' + process.platform,\n          'Actual Arch: ' + process.arch,\n        ].join('\\n'),\n      ])\n      break\n    }\n\n    case 'EEXIST':\n      short.push(['', er.message])\n      short.push(['', 'File exists: ' + (er.dest || er.path)])\n      detail.push(['', 'Remove the existing file and try again, or run npm'])\n      detail.push(['', 'with --force to overwrite files recklessly.'])\n      break\n\n    case 'ENEEDAUTH':\n      short.push(['need auth', er.message])\n      detail.push(['need auth', 'You need to authorize this machine using `npm adduser`'])\n      break\n\n    case 'ECONNRESET':\n    case 'ENOTFOUND':\n    case 'ETIMEDOUT':\n    case 'EAI_FAIL':\n      short.push(['network', er.message])\n      detail.push([\n        'network',\n        [\n          'This is a problem related to network connectivity.',\n          'In most cases you are behind a proxy or have bad network settings.',\n          '\\nIf you are behind a proxy, please make sure that the',\n          \"'proxy' config is set properly.  See: 'npm help config'\",\n        ].join('\\n'),\n      ])\n      break\n\n    case 'ETARGET':\n      short.push(['notarget', er.message])\n      detail.push(['notarget', [\n        'In most cases you or one of your dependencies are requesting',\n        \"a package version that doesn't exist.\",\n      ].join('\\n')])\n      break\n\n    case 'E403':\n      short.push(['403', er.message])\n      detail.push(['403', [\n        'In most cases, you or one of your dependencies are requesting',\n        'a package version that is forbidden by your security policy, or',\n        'on a server you do not have access to.',\n      ].join('\\n')])\n      break\n\n    case 'EBADENGINE':\n      short.push(['engine', er.message])\n      short.push(['engine', 'Not compatible with your version of node/npm: ' + er.pkgid])\n      detail.push([\n        'notsup',\n        [\n          'Not compatible with your version of node/npm: ' + er.pkgid,\n          'Required: ' + JSON.stringify(er.required),\n          'Actual:   ' + JSON.stringify({\n            npm: npm.version,\n            node: npm.config.loaded ? npm.config.get('node-version') : process.version,\n          }),\n        ].join('\\n'),\n      ])\n      break\n\n    case 'ENOSPC':\n      short.push(['nospc', er.message])\n      detail.push([\n        'nospc',\n        [\n          'There appears to be insufficient space on your system to finish.',\n          'Clear up some disk space and try again.',\n        ].join('\\n'),\n      ])\n      break\n\n    case 'EROFS':\n      short.push(['rofs', er.message])\n      detail.push([\n        'rofs',\n        [\n          'Often virtualized file systems, or other file systems',\n          \"that don't support symlinks, give this error.\",\n        ].join('\\n'),\n      ])\n      break\n\n    case 'ENOENT':\n      short.push(['enoent', er.message])\n      detail.push([\n        'enoent',\n        [\n          'This is related to npm not being able to find a file.',\n          er.file ? \"\\nCheck if the file '\" + er.file + \"' is present.\" : '',\n        ].join('\\n'),\n      ])\n      break\n\n    case 'EMISSINGARG':\n    case 'EUNKNOWNTYPE':\n    case 'EINVALIDTYPE':\n    case 'ETOOMANYARGS':\n      short.push(['typeerror', er.stack])\n      detail.push([\n        'typeerror',\n        [\n          'This is an error with npm itself. Please report this error at:',\n          '    https://github.com/npm/cli/issues',\n        ].join('\\n'),\n      ])\n      break\n\n    default:\n      short.push(['', er.message || er])\n      if (er.signal)\n        detail.push(['signal', er.signal])\n\n      if (er.cmd && Array.isArray(er.args))\n        detail.push(['command', ...[er.cmd, ...er.args]])\n\n      if (er.stdout)\n        detail.push(['', er.stdout.trim()])\n\n      if (er.stderr)\n        detail.push(['', er.stderr.trim()])\n\n      break\n  }\n  return { summary: short, detail: detail }\n}\n"]},"metadata":{},"sourceType":"script"}