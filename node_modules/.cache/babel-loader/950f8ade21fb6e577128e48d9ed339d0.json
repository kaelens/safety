{"ast":null,"code":"'use strict';\n\nconst colors = require('../colors.js');\n\nconst install = require('./install.js');\n\nmodule.exports = (data, {\n  color\n}) => {\n  const summary = install.summary(data, {\n    color\n  });\n  const none = data.metadata.vulnerabilities.total === 0;\n  return none ? summary : fullReport(data, {\n    color,\n    summary\n  });\n};\n\nconst fullReport = (data, {\n  color,\n  summary\n}) => {\n  const c = colors(color);\n  const output = [c.white('# npm audit report'), ''];\n  const printed = new Set();\n\n  for (const [name, vuln] of Object.entries(data.vulnerabilities)) {\n    // only print starting from the top-level advisories\n    if (vuln.via.filter(v => typeof v !== 'string').length !== 0) output.push(printVuln(vuln, c, data.vulnerabilities));\n  }\n\n  output.push(summary);\n  return output.join('\\n');\n};\n\nconst printVuln = (vuln, c, vulnerabilities, printed = new Set(), indent = '') => {\n  if (printed.has(vuln)) return null;\n  printed.add(vuln);\n  const output = [];\n  output.push(c.white(vuln.name) + '  ' + vuln.range);\n\n  if (indent === '' && (vuln.severity !== 'low' || vuln.severity === 'info')) {\n    output.push(`Severity: ${c.severity(vuln.severity)}`);\n  }\n\n  for (const via of vuln.via) {\n    if (typeof via === 'string') {\n      output.push(`Depends on vulnerable versions of ${c.white(via)}`);\n    } else if (indent === '') {\n      output.push(`${c.white(via.title)} - ${via.url}`);\n    }\n  }\n\n  if (indent === '') {\n    const {\n      fixAvailable: fa\n    } = vuln;\n\n    if (fa === false) {\n      output.push(c.red('No fix available'));\n    } else if (fa === true) {\n      output.push(c.green('fix available') + ' via `npm audit fix`');\n    } else {\n      /* istanbul ignore else - should be impossible, just being cautious */\n      if (typeof fa === 'object' && indent === '') {\n        output.push(`${c.yellow('fix available')} via \\`npm audit fix --force\\``, `Will install ${fa.name}@${fa.version}` + `, which is ${fa.isSemVerMajor ? 'a breaking change' : 'outside the stated dependency range'}`);\n      }\n    }\n  }\n\n  for (const path of vuln.nodes) {\n    output.push(c.dim(path));\n  }\n\n  for (const effect of vuln.effects) {\n    const vuln = vulnerabilities[effect];\n    const e = printVuln(vuln, c, vulnerabilities, printed, '  ');\n    if (e) output.push(...e.split('\\n'));\n  }\n\n  if (indent === '') {\n    output.push('');\n  }\n\n  return output.map(l => `${indent}${l}`).join('\\n');\n};","map":{"version":3,"sources":["/Users/kaelen/nsc-mds/node_modules/npm/node_modules/npm-audit-report/lib/reporters/detail.js"],"names":["colors","require","install","module","exports","data","color","summary","none","metadata","vulnerabilities","total","fullReport","c","output","white","printed","Set","name","vuln","Object","entries","via","filter","v","length","push","printVuln","join","indent","has","add","range","severity","title","url","fixAvailable","fa","red","green","yellow","version","isSemVerMajor","path","nodes","dim","effect","effects","e","split","map","l"],"mappings":"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","sourcesContent":["'use strict'\n\nconst colors = require('../colors.js')\nconst install = require('./install.js')\n\nmodule.exports = (data, { color }) => {\n  const summary = install.summary(data, { color })\n  const none = data.metadata.vulnerabilities.total === 0\n  return none ? summary : fullReport(data, {color, summary})\n}\n\nconst fullReport = (data, { color, summary }) => {\n  const c = colors(color)\n  const output = [c.white('# npm audit report'), '']\n\n  const printed = new Set()\n  for (const [name, vuln] of Object.entries(data.vulnerabilities)) {\n    // only print starting from the top-level advisories\n    if (vuln.via.filter(v => typeof v !== 'string').length !== 0)\n      output.push(printVuln(vuln, c, data.vulnerabilities))\n  }\n\n  output.push(summary)\n\n  return output.join('\\n')\n}\n\nconst printVuln = (vuln, c, vulnerabilities, printed = new Set(), indent = '') => {\n  if (printed.has(vuln))\n    return null\n\n  printed.add(vuln)\n  const output = []\n\n  output.push(c.white(vuln.name) + '  ' + vuln.range)\n\n  if (indent === '' && (vuln.severity !== 'low' || vuln.severity === 'info')) {\n    output.push(`Severity: ${c.severity(vuln.severity)}`)\n  }\n\n  for (const via of vuln.via) {\n    if (typeof via === 'string') {\n      output.push(`Depends on vulnerable versions of ${c.white(via)}`)\n    } else if (indent === '') {\n      output.push(`${c.white(via.title)} - ${via.url}`)\n    }\n  }\n\n  if (indent === '') {\n    const { fixAvailable: fa } = vuln\n    if (fa === false) {\n      output.push(c.red('No fix available'))\n    } else if (fa === true) {\n      output.push(c.green('fix available') + ' via `npm audit fix`')\n    } else {\n      /* istanbul ignore else - should be impossible, just being cautious */\n      if (typeof fa === 'object' && indent === '') {\n        output.push(\n          `${c.yellow('fix available')} via \\`npm audit fix --force\\``,\n          `Will install ${fa.name}@${fa.version}` +\n          `, which is ${fa.isSemVerMajor ? 'a breaking change' :\n            'outside the stated dependency range' }`\n        )\n      }\n    }\n  }\n\n  for (const path of vuln.nodes) {\n    output.push(c.dim(path))\n  }\n\n  for (const effect of vuln.effects) {\n    const vuln = vulnerabilities[effect]\n    const e = printVuln(vuln, c, vulnerabilities, printed, '  ')\n    if (e)\n      output.push(...e.split('\\n'))\n  }\n\n  if (indent === '') {\n    output.push('')\n  }\n\n  return output.map(l => `${indent}${l}`).join('\\n')\n}\n"]},"metadata":{},"sourceType":"script"}