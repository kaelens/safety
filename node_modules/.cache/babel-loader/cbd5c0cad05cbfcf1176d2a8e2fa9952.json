{"ast":null,"code":"'use strict';\n\nconst fetch = require('npm-registry-fetch');\n\nconst validate = require('aproba');\n\nconst eu = encodeURIComponent;\nconst cmd = module.exports = {};\n\ncmd.add = (name, endpoint, secret, opts = {}) => {\n  validate('SSSO', [name, endpoint, secret, opts]);\n  let type = 'package';\n\n  if (name.match(/^@[^/]+$/)) {\n    type = 'scope';\n  }\n\n  if (name[0] === '~') {\n    type = 'owner';\n    name = name.substr(1);\n  }\n\n  return fetch.json('/-/npm/v1/hooks/hook', { ...opts,\n    method: 'POST',\n    body: {\n      type,\n      name,\n      endpoint,\n      secret\n    }\n  });\n};\n\ncmd.rm = (id, opts = {}) => {\n  validate('SO', [id, opts]);\n  return fetch.json(`/-/npm/v1/hooks/hook/${eu(id)}`, { ...opts,\n    method: 'DELETE'\n  }).catch(err => {\n    if (err.code === 'E404') {\n      return null;\n    } else {\n      throw err;\n    }\n  });\n};\n\ncmd.update = (id, endpoint, secret, opts = {}) => {\n  validate('SSSO', [id, endpoint, secret, opts]);\n  return fetch.json(`/-/npm/v1/hooks/hook/${eu(id)}`, { ...opts,\n    method: 'PUT',\n    body: {\n      endpoint,\n      secret\n    }\n  });\n};\n\ncmd.find = (id, opts = {}) => {\n  validate('SO', [id, opts]);\n  return fetch.json(`/-/npm/v1/hooks/hook/${eu(id)}`, opts);\n};\n\ncmd.ls = (opts = {}) => {\n  return cmd.ls.stream(opts).collect();\n};\n\ncmd.ls.stream = (opts = {}) => {\n  const {\n    package: pkg,\n    limit,\n    offset\n  } = opts;\n  validate('S|Z', [pkg]);\n  validate('N|Z', [limit]);\n  validate('N|Z', [offset]);\n  return fetch.json.stream('/-/npm/v1/hooks', 'objects.*', { ...opts,\n    query: {\n      package: pkg,\n      limit,\n      offset\n    }\n  });\n};","map":{"version":3,"sources":["/Users/kaelen/nsc-mds/node_modules/npm/node_modules/libnpmhook/index.js"],"names":["fetch","require","validate","eu","encodeURIComponent","cmd","module","exports","add","name","endpoint","secret","opts","type","match","substr","json","method","body","rm","id","catch","err","code","update","find","ls","stream","collect","package","pkg","limit","offset","query"],"mappings":"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","sourcesContent":["'use strict'\n\nconst fetch = require('npm-registry-fetch')\nconst validate = require('aproba')\n\nconst eu = encodeURIComponent\nconst cmd = module.exports = {}\ncmd.add = (name, endpoint, secret, opts = {}) => {\n  validate('SSSO', [name, endpoint, secret, opts])\n  let type = 'package'\n  if (name.match(/^@[^/]+$/)) {\n    type = 'scope'\n  }\n  if (name[0] === '~') {\n    type = 'owner'\n    name = name.substr(1)\n  }\n  return fetch.json('/-/npm/v1/hooks/hook', {\n    ...opts,\n    method: 'POST',\n    body: { type, name, endpoint, secret }\n  })\n}\n\ncmd.rm = (id, opts = {}) => {\n  validate('SO', [id, opts])\n  return fetch.json(`/-/npm/v1/hooks/hook/${eu(id)}`, {\n    ...opts,\n    method: 'DELETE'\n  }).catch(err => {\n    if (err.code === 'E404') {\n      return null\n    } else {\n      throw err\n    }\n  })\n}\n\ncmd.update = (id, endpoint, secret, opts = {}) => {\n  validate('SSSO', [id, endpoint, secret, opts])\n  return fetch.json(`/-/npm/v1/hooks/hook/${eu(id)}`, {\n    ...opts,\n    method: 'PUT',\n    body: {endpoint, secret}\n  })\n}\n\ncmd.find = (id, opts = {}) => {\n  validate('SO', [id, opts])\n  return fetch.json(`/-/npm/v1/hooks/hook/${eu(id)}`, opts)\n}\n\ncmd.ls = (opts = {}) => {\n  return cmd.ls.stream(opts).collect()\n}\n\ncmd.ls.stream = (opts = {}) => {\n  const { package: pkg, limit, offset } = opts\n  validate('S|Z', [pkg])\n  validate('N|Z', [limit])\n  validate('N|Z', [offset])\n  return fetch.json.stream('/-/npm/v1/hooks', 'objects.*', {\n    ...opts,\n    query: {\n      package: pkg,\n      limit,\n      offset\n    }\n  })\n}\n"]},"metadata":{},"sourceType":"script"}